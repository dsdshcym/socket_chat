#!/usr/bin/env ruby

require "socket_chat/client"
require "optparse"

server = "localhost"
port   = 8000

OptionParser.new do |opts|
  opts.banner = "Usage: socket_chat_client [options]"

  opts.on("-s", "--server [SERVER]", "Server's IP address (Default: localhost)") do |s|
    server = s
  end

  opts.on("-p", "--port [PORT]", "Server's port (Default: 8000)") do |p|
    port = p.to_i
  end

  opts.on("-h", "--help", "Print this help") do
    puts opts
    exit
  end
end.parse!

begin
  client = Client.new(server, port)
rescue Errno::ECONNREFUSED
  puts "Connection refused.\nPlease check your server and port input."
  exit
end

puts "Please login to enter the chat room."
client.run
